{"ast":null,"code":"import _Tooltip from \"antd/lib/tooltip\";\nimport _Dropdown from \"antd/lib/dropdown\";\nimport _Avatar from \"antd/lib/avatar\";\nimport _Input from \"antd/lib/input\";\nimport _Icon from \"antd/lib/icon\";\nimport _Menu from \"antd/lib/menu\";\nimport _Layout from \"antd/lib/layout\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useCallback } from 'react';\nimport getConfig from 'next/config';\nimport { connect } from 'react-redux';\nimport { withRouter, Router } from 'next/router';\nimport axios from 'axios';\nimport Container from './Container';\nimport { logout } from '../store/store';\nimport Link from 'next/link';\nconst {\n  Header,\n  Content,\n  Footer\n} = _Layout;\nconst {\n  publicRuntimeConfig\n} = getConfig();\nconst githubIconStyle = {\n  color: 'white',\n  fontSize: 40,\n  display: 'block',\n  paddingTop: 10,\n  paddingRight: 20\n};\nexport const footerStyled = {\n  textAlign: 'center'\n};\n\nfunction MyLayout({\n  children,\n  user,\n  logout,\n  router\n}) {\n  const urlQuery = router.query && router.query.query;\n  const {\n    0: search,\n    1: setSearch\n  } = useState(urlQuery || '');\n  const handleSearchChange = useCallback(event => {\n    setSearch(event.target.value);\n  }, [setSearch]);\n  const handleOnSearch = useCallback(() => {\n    Router.push(`/search?query=${search}`);\n  }, [search]);\n  const handleLogout = useCallback(() => {\n    logout();\n  }, [logout]);\n  const handleGotoOAuth = useCallback(e => {\n    e.preventDefault(); // 组织跳转\n    // asPath - 展现在浏览器上的实际路径，包含查询内容，为String类型\n\n    axios.get(`/prepare-auth?url=${router.asPath}`).then(res => {\n      if (res.status === 200) {\n        location.href = publicRuntimeConfig.OAUTH_URL;\n      } else {\n        console.log('prepare auth failed', res);\n      }\n    }).catch(err => {\n      console.log('prepare auth failed', err);\n    });\n  }, []);\n\n  const userDropDown = __jsx(_Menu, null, __jsx(_Menu.Item, null, __jsx(\"a\", {\n    href: \"javascript:void(0)\",\n    onClick: handleLogout\n  }, \"\\u767B\\u51FA\")));\n\n  return __jsx(_Layout, null, __jsx(Header, null, __jsx(Container, {\n    render: __jsx(\"div\", {\n      className: \"jsx-3254973331\" + \" \" + \"header-inner\"\n    })\n  }, __jsx(\"div\", {\n    className: \"jsx-3254973331\" + \" \" + \"header-left\"\n  }, __jsx(\"div\", {\n    className: \"jsx-3254973331\" + \" \" + 'logo'\n  }, __jsx(Link, {\n    href: \"/\"\n  }, __jsx(_Icon, {\n    type: \"github\",\n    style: githubIconStyle\n  }))), __jsx(\"div\", {\n    className: \"jsx-3254973331\"\n  }, __jsx(_Input.Search, {\n    placeholder: \"\\u641C\\u7D22\\u4ED3\\u5E93\",\n    value: search,\n    onChange: handleSearchChange,\n    onSearch: handleOnSearch\n  }))), __jsx(\"div\", {\n    className: \"jsx-3254973331\" + \" \" + 'header-right'\n  }, __jsx(\"div\", {\n    className: \"jsx-3254973331\" + \" \" + \"user\"\n  }, user && user.id ? __jsx(_Dropdown, {\n    overlay: userDropDown\n  }, __jsx(\"a\", {\n    href: \"/\",\n    className: \"jsx-3254973331\"\n  }, __jsx(_Avatar, {\n    size: 40,\n    src: user.avatar_url\n  }))) : __jsx(_Tooltip, {\n    title: \"\\u70B9\\u51FB\\u8FDB\\u884C\\u767B\\u5F55\"\n  }, __jsx(\"a\", {\n    href: `/prepare-auth?url=${router.asPath}`,\n    className: \"jsx-3254973331\"\n  }, __jsx(_Avatar, {\n    size: 40,\n    icon: \"user\"\n  }))))))), __jsx(Content, null, __jsx(Container, null, children)), __jsx(Footer, {\n    style: footerStyled\n  }, \"Develop by wydumn\"), __jsx(_JSXStyle, {\n    id: \"2443374783\"\n  }, [\".header-inner.jsx-3254973331{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}\", \".header-left.jsx-3254973331{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;}\"]), __jsx(_JSXStyle, {\n    id: \"900660709\"\n  }, [\"#__next{height:100%;}\", \".ant-layout{min-height:100%;}\", \".ant-layout-header{padding-left:0;padding-right:0;}\", \".ant-layout-content{background:#fff;}\"]));\n}\n\nexport default connect(function mapStateToProps(state) {\n  return {\n    user: state.user\n  };\n}, function mapDispatchToProps(dispatch) {\n  return {\n    logout: () => dispatch(logout())\n  };\n})(withRouter(MyLayout));","map":null,"metadata":{},"sourceType":"module"}