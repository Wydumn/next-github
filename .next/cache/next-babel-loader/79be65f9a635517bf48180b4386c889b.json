{"ast":null,"code":"const axios = require('axios');\n\nconst github_base_url = 'https://api.github.com';\n\nasync function requestGithub(method, url, data, headers) {\n  return await axios({\n    method,\n    url: `${github_base_url}${url}`,\n    data,\n    headers\n  });\n}\n\nconst isServer = true;\n\nasync function request({\n  method = 'GET',\n  url,\n  data = {}\n}, req, res) {\n  if (!url) {\n    // url必须要存在\n    throw Error('url must provide');\n  }\n\n  if (isServer) {\n    const session = req.session;\n    const githubAuth = session.githubAuth || {};\n    const headers = {};\n\n    if (githubAuth.access_token) {\n      headers['Authorization'] = `${githubAuth.token_type} ${githubAuth.access_token}`;\n    }\n\n    return await requestGithub(method, url, data, headers);\n  } else {\n    return await axios({\n      method,\n      url: `/github${url}`,\n      data\n    });\n  }\n}\n\nmodule.exports = {\n  request,\n  requestGithub\n};","map":null,"metadata":{},"sourceType":"script"}